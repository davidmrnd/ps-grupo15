<header>

  <div class="header-container">
    <div class="left-container">
      <div class="logo-container">
        <a routerLink="/"><img src="/assets/images/logo.webp" alt="Logo"></a>
      </div>
      
      <nav class="nav-links">
        <a routerLink="/">Inicio</a>
        <a routerLink="/categories">Explorar</a>
        <a *ngIf="isLoggedIn; else redirectToLogin" routerLink="/following">Siguiendo</a>
        <ng-template #redirectToLogin>
          <a routerLink="/login">Siguiendo</a>
        </ng-template>
      </nav>
      <button class="menu-button">‚ò∞</button>


    </div>

    <div class="categories-dropdown-container">
     <button (click)="toggleDropdown()" class="dropdown-button">Filtrar Categor√≠as</button>
      <div *ngIf="showDropdown" class="categories-dropdown">
        <div class="categories-grid">
          <label *ngFor="let category of allCategories" class="category-item" [class.selected]="selectedCategories.includes(category)">
            <input
              type="checkbox"
              [value]="category"
              [checked]="selectedCategories.includes(category)"
              (change)="onCategoryChange($event)"
            />
            {{ category }}
          </label>
        </div>
      </div>
  </div>

    <div class="search-container">
      <input
        type="text"
        class="search-box"
        placeholder="Buscar"
        [(ngModel)]="searchText"
        (keydown)="onKeyDowmInSearchInput($event)"
      />
      <button class="search-button" (click)="onSearchButtonClicked()">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <circle cx="9" cy="9" r="8" stroke="black" stroke-width="2"/>
          <line x1="14" y1="14" x2="19" y2="19" stroke="black" stroke-width="2"/>
        </svg>
      </button>
    </div>
    <div class="search-toggle">
      <input type="radio" id="user" name="searchType" value="user" [(ngModel)]="searchType" />
      <label for="user">Usuario</label>
      <input type="radio" id="videogame" name="searchType" value="videogame" [(ngModel)]="searchType" />
      <label for="videogame">Videojuego</label>
      <div class="toggle-slider"></div>
    </div>
    <app-search-results
      [searchResults]="searchResults"
      [searchType]="searchType"
      (searchResultClicked)="clearSearchText()"
      [showSearchResults]="showSearchResults"
    ></app-search-results>

    <div class="right-container">
      <div class="dark-mode-switch">
        <span class="icon-sun">‚òÄÔ∏è</span>
        <label class="switch">
          <input type="checkbox" [checked]="isDarkModeEnabled" (change)="toggleDarkMode()">
          <span class="slider"></span>
        </label>
        <span class="icon-moon">üåô</span>
      </div>
      <ng-container *ngIf="isLoggedIn; else guestButtons">
        <div class="user-dropdown-container" (click)="toggleUserDropdown()" tabindex="0">
          <img class="profile-img" [src]="userProfileIcon" alt="Perfil">
          <div class="user-dropdown" *ngIf="showUserDropdown">
            <a [routerLink]="['/user', userId]" (click)="closeUserDropdown()">Mi Perfil</a>
            <button (click)="logout(); closeUserDropdown()" class="logout-dropdown-btn">Cerrar sesi√≥n</button>
          </div>
        </div>
      </ng-container>
      <ng-template #guestButtons>
        <a routerLink="/registration"><button class="cta-button">Registrarse</button></a>
        <a routerLink="/login" class="login-text">Iniciar sesi√≥n</a>
      </ng-template>
    </div>
  </div>
</header>
